import SwiftUI

struct DonutChart: View {
    var progress: Double        // 0.0 → 1.0
    private let lineWidth: CGFloat = 28

    @State private var animatedProgress: Double = 0

    private let gold = Color(red: 0.851, green: 0.537, blue: 0.157)
    private let lightRing = Color(red: 0.90, green: 0.86, blue: 0.80)

    var body: some View {
        ZStack {
            // BACKGROUND RING — always fully visible
            Circle()
                .trim(from: 0, to: 1)
                .stroke(
                    lightRing.opacity(0.45),
                    style: StrokeStyle(lineWidth: lineWidth, lineCap: .round)
                )
                .rotationEffect(.degrees(-90))

            // FOREGROUND PROGRESS RING — animates
            Circle()
                .trim(from: 0, to: animatedProgress)
                .stroke(
                    gold,
                    style: StrokeStyle(lineWidth: lineWidth, lineCap: .round)
                )
                .rotationEffect(.degrees(-90))
                .animation(.easeOut(duration: 1.1), value: animatedProgress)

            // CENTER %
            Text("\(Int(progress * 100))%")
                .font(.custom("Konkhmer Sleokchher", size: 26))
                .foregroundColor(Color(red: 0.145, green: 0.098, blue: 0.051))
        }
        .frame(width: 215, height: 215)
        .onAppear {
            animatedProgress = progress     // triggers animation smoothly
        }
    }
}
